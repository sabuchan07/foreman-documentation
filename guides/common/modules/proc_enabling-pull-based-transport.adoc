[id="enabling-pull-based-tranport_{context}"]
= Enabling Pull-based Transport

If your {Project} or {SmartProxy} is preinstalled, use the following procedure to enable pull-based transport.

.Procedure

. To install the remote execution script, run:
ifdef::satellite[]
----
{satellite-installer} --foreman-proxy-plugin-remote-execution-script-mode=pull-mqtt
----
endif::[]
ifdef::foreman,orcharhino,katello[]
----
{foreman-installer} --foreman-proxy-plugin-remote-execution-script-mode=pull-mqtt
----
endif::[]

// Start this list from 2.
[start=2]
. To enable the {SmartProxy} for host registration, run:

----
{foreman-installer} --foreman-proxy-templates=true --foreman-proxy-registration=true
----

// Start this list from 3.
[start=3]
. To enable the pull provider, run:
ifdef::satellite[]
----
{satellite-installer} --foreman-proxy-plugin-remote-execution-script-mode=pull-mqtt
----
endif::[]

ifdef::foreman,orcharhino,katello[]
----
{foreman-installer} --foreman-proxy-plugin-remote-execution-script-mode=pull-mqtt.
----
endif::[]

// Start this list from 4.
[start=4]
. When the installer command succeeds, the MQTT broker s at port 1883.
You must allow that port in your firewall by running the following commands:

** `firewall-cmd --add-port="1883/tcp"`
** `firewall-cmd --runtime-to-permanent`

. Choose one of the following three options to enable hosts to work with MQTT for pull provider:
** Migrate existing clients to pull provider.
If your client is already registered to {Project}, you can convert the client to the pull-based transport if the client has access to the {Project} Client repository.

*** For more information on converting clients to pull-based transport, see <<Converting a Client to Pull-based Transport>>.

** Register clients to pull the provider {SmartProxy}.
In the *Hosts* > *Register host* > *Advanced* tab, if the *REX pull mode* is set to *Yes*, the pull provider client is set up during host registration.

ifdef::satellite[]
To register your host with the pull client configuration option enabled, navigate to the advanced fields of the *Global Registration Form* and set `REX pull mode` to `Yes`.
If you make no changes and leave the field on default, the value remains `Inherit from host parameter`.
endif::[]

** Provision clients to connect to pull provider.
If you set the `enable-remote-execution-pull` parameter to `true`, the pull provider client is set up during host registration, and the `remote_execution_pull_setup` template runs jobs during provisioning.
